```python
# è‡ªåŠ¨è®¡ç®—cellçš„è®¡ç®—æ—¶é—´
%load_ext autotime

%matplotlib inline
%config InlineBackend.figure_format='svg' #çŸ¢é‡å›¾è®¾ç½®ï¼Œè®©ç»˜å›¾æ›´æ¸…æ™°
```

# 2-1,å¼ é‡æ•°æ®ç»“æ„

Pytorchçš„åŸºæœ¬æ•°æ®ç»“æ„æ˜¯å¼ é‡Tensorã€‚å¼ é‡å³å¤šç»´æ•°ç»„ã€‚Pytorchçš„å¼ é‡å’Œnumpyä¸­çš„arrayå¾ˆç±»ä¼¼ã€‚

æœ¬èŠ‚æˆ‘ä»¬ä¸»è¦ä»‹ç»å¼ é‡çš„æ•°æ®ç±»å‹ã€å¼ é‡çš„ç»´åº¦ã€å¼ é‡çš„å°ºå¯¸ã€å¼ é‡å’Œnumpyæ•°ç»„ç­‰åŸºæœ¬æ¦‚å¿µã€‚



### ä¸€ï¼Œå¼ é‡çš„æ•°æ®ç±»å‹


å¼ é‡çš„æ•°æ®ç±»å‹å’Œnumpy.arrayåŸºæœ¬ä¸€ä¸€å¯¹åº”ï¼Œä½†æ˜¯ä¸æ”¯æŒstrç±»å‹ã€‚

åŒ…æ‹¬:

torch.float64(torch.double), 

**torch.float32(torch.float)**, 

torch.float16, 

torch.int64(torch.long), 

torch.int32(torch.int), 

torch.int16, 

torch.int8, 

torch.uint8, 

torch.bool

ä¸€èˆ¬ç¥ç»ç½‘ç»œå»ºæ¨¡ä½¿ç”¨çš„éƒ½æ˜¯torch.float32ç±»å‹ã€‚ 

```python
import numpy as np
import torch 

# è‡ªåŠ¨æ¨æ–­æ•°æ®ç±»å‹

i = torch.tensor(1);print(i,i.dtype)
x = torch.tensor(2.0);print(x,x.dtype)
b = torch.tensor(True);print(b,b.dtype)
```

```python
# æŒ‡å®šæ•°æ®ç±»å‹

i = torch.tensor(1,dtype = torch.int32);print(i,i.dtype)
x = torch.tensor(2.0,dtype = torch.double);print(x,x.dtype)
```

```python
# ä½¿ç”¨ç‰¹å®šç±»å‹æ„é€ å‡½æ•°

i = torch.IntTensor(1);print(i,i.dtype)
x = torch.Tensor(np.array(2.0));print(x,x.dtype) #ç­‰ä»·äºtorch.FloatTensor
b = torch.BoolTensor(np.array([1,0,2,0])); print(b,b.dtype)
```

```python
# ä¸åŒç±»å‹è¿›è¡Œè½¬æ¢

i = torch.tensor(1); print(i,i.dtype)

x = i.float(); print(x,x.dtype) #è°ƒç”¨ floatæ–¹æ³•è½¬æ¢æˆæµ®ç‚¹ç±»å‹

y = i.type(torch.float); print(y,y.dtype) #ä½¿ç”¨typeå‡½æ•°è½¬æ¢æˆæµ®ç‚¹ç±»å‹

z = i.type_as(x);print(z,z.dtype) #ä½¿ç”¨type_asæ–¹æ³•è½¬æ¢æˆæŸä¸ªTensorç›¸åŒç±»å‹
```

### äºŒï¼Œå¼ é‡çš„ç»´åº¦


ä¸åŒç±»å‹çš„æ•°æ®å¯ä»¥ç”¨ä¸åŒç»´åº¦(dimension)çš„å¼ é‡æ¥è¡¨ç¤ºã€‚

æ ‡é‡ä¸º0ç»´å¼ é‡ï¼Œå‘é‡ä¸º1ç»´å¼ é‡ï¼ŒçŸ©é˜µä¸º2ç»´å¼ é‡ã€‚

å½©è‰²å›¾åƒæœ‰rgbä¸‰ä¸ªé€šé“ï¼Œå¯ä»¥è¡¨ç¤ºä¸º3ç»´å¼ é‡ã€‚

è§†é¢‘è¿˜æœ‰æ—¶é—´ç»´ï¼Œå¯ä»¥è¡¨ç¤ºä¸º4ç»´å¼ é‡ã€‚

å¯ä»¥ç®€å•åœ°æ€»ç»“ä¸ºï¼šæœ‰å‡ å±‚ä¸­æ‹¬å·ï¼Œå°±æ˜¯å¤šå°‘ç»´çš„å¼ é‡ã€‚

```python
scalar = torch.tensor(True)
print(scalar)
print(scalar.dim())  # æ ‡é‡ï¼Œ0ç»´å¼ é‡
```

```python
vector = torch.tensor([1.0,2.0,3.0,4.0]) #å‘é‡ï¼Œ1ç»´å¼ é‡
print(vector)
print(vector.dim())
```

```python
matrix = torch.tensor([[1.0,2.0],[3.0,4.0]]) #çŸ©é˜µ, 2ç»´å¼ é‡
print(matrix)
print(matrix.dim())
```

```python
tensor3 = torch.tensor([[[1.0,2.0],[3.0,4.0]],[[5.0,6.0],[7.0,8.0]]])  # 3ç»´å¼ é‡
print(tensor3)
print(tensor3.dim())
```

```python
tensor4 = torch.tensor([[[[1.0,1.0],[2.0,2.0]],[[3.0,3.0],[4.0,4.0]]],
                        [[[5.0,5.0],[6.0,6.0]],[[7.0,7.0],[8.0,8.0]]]])  # 4ç»´å¼ é‡
print(tensor4)
print(tensor4.dim())
```

```python
len(tensor4.shape) == tensor4.dim()
```

### ä¸‰ï¼Œå¼ é‡çš„å°ºå¯¸


å¯ä»¥ä½¿ç”¨ shapeå±æ€§æˆ–è€… size()æ–¹æ³•æŸ¥çœ‹å¼ é‡åœ¨æ¯ä¸€ç»´çš„é•¿åº¦.

å¯ä»¥ä½¿ç”¨viewæ–¹æ³•æ”¹å˜å¼ é‡çš„å°ºå¯¸ã€‚

å¦‚æœviewæ–¹æ³•æ”¹å˜å°ºå¯¸å¤±è´¥ï¼Œå¯ä»¥ä½¿ç”¨reshapeæ–¹æ³•.

```python
scalar = torch.tensor(True)
print(scalar.size())
print(scalar.shape)
```

```python
vector = torch.tensor([1.0,2.0,3.0,4.0])
print(vector.size())
print(vector.shape)
```

```python
matrix = torch.tensor([[1.0,2.0],[3.0,4.0]])
print(matrix.size())
```

```python
# ä½¿ç”¨viewå¯ä»¥æ”¹å˜å¼ é‡å°ºå¯¸

vector = torch.arange(0,12)
print(vector)
print(vector.shape)

matrix34 = vector.view(3,4)
print(matrix34)
print(matrix34.shape)

matrix43 = vector.view(4,-1) #-1è¡¨ç¤ºè¯¥ä½ç½®é•¿åº¦ç”±ç¨‹åºè‡ªåŠ¨æ¨æ–­
print(matrix43)
print(matrix43.shape)
```

```python
# æœ‰äº›æ“ä½œä¼šè®©å¼ é‡å­˜å‚¨ç»“æ„æ‰­æ›²ï¼Œç›´æ¥ä½¿ç”¨viewä¼šå¤±è´¥ï¼Œå¯ä»¥ç”¨reshapeæ–¹æ³•

matrix26 = torch.arange(0,12).view(2,6)
print(matrix26)
print(matrix26.shape)

# è½¬ç½®æ“ä½œè®©å¼ é‡å­˜å‚¨ç»“æ„æ‰­æ›²
matrix62 = matrix26.t()
print(matrix62.is_contiguous())


# ç›´æ¥ä½¿ç”¨viewæ–¹æ³•ä¼šå¤±è´¥ï¼Œå¯ä»¥ä½¿ç”¨reshapeæ–¹æ³•
#matrix34 = matrix62.view(3,4) #error!
matrix34 = matrix62.reshape(3,4) #ç­‰ä»·äºmatrix34 = matrix62.contiguous().view(3,4)
print(matrix34)
```

### å››ï¼Œå¼ é‡å’Œnumpyæ•°ç»„


å¯ä»¥ç”¨numpyæ–¹æ³•ä»Tensorå¾—åˆ°numpyæ•°ç»„ï¼Œä¹Ÿå¯ä»¥ç”¨torch.from_numpyä»numpyæ•°ç»„å¾—åˆ°Tensorã€‚

è¿™ä¸¤ç§æ–¹æ³•å…³è”çš„Tensorå’Œnumpyæ•°ç»„æ˜¯å…±äº«æ•°æ®å†…å­˜çš„ã€‚

å¦‚æœæ”¹å˜å…¶ä¸­ä¸€ä¸ªï¼Œå¦å¤–ä¸€ä¸ªçš„å€¼ä¹Ÿä¼šå‘ç”Ÿæ”¹å˜ã€‚

å¦‚æœæœ‰éœ€è¦ï¼Œå¯ä»¥ç”¨å¼ é‡çš„cloneæ–¹æ³•æ‹·è´å¼ é‡ï¼Œä¸­æ–­è¿™ç§å…³è”ã€‚

æ­¤å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨itemæ–¹æ³•ä»æ ‡é‡å¼ é‡å¾—åˆ°å¯¹åº”çš„Pythonæ•°å€¼ã€‚

ä½¿ç”¨tolistæ–¹æ³•ä»å¼ é‡å¾—åˆ°å¯¹åº”çš„Pythonæ•°å€¼åˆ—è¡¨ã€‚


```python
import numpy as np
import torch 
```

```python
#torch.from_numpyå‡½æ•°ä»numpyæ•°ç»„å¾—åˆ°Tensor

arr = np.zeros(3)
tensor = torch.from_numpy(arr)
print("before add 1:")
print(arr)
print(tensor)

print("\nafter add 1:")
np.add(arr,1, out = arr) #ç»™ arrå¢åŠ 1ï¼Œtensorä¹Ÿéšä¹‹æ”¹å˜
print(arr)
print(tensor)
```

```python
arr = np.zeros(3)
tensor = torch.from_numpy(arr)
tensor + 1
```

```python
# numpyæ–¹æ³•ä»Tensorå¾—åˆ°numpyæ•°ç»„

tensor = torch.zeros(3)
arr = tensor.numpy()
print("before add 1:")
print(tensor)
print(arr)

print("\nafter add 1:")

#ä½¿ç”¨å¸¦ä¸‹åˆ’çº¿çš„æ–¹æ³•è¡¨ç¤ºè®¡ç®—ç»“æœä¼šè¿”å›ç»™è°ƒç”¨ å¼ é‡
tensor.add_(1) #ç»™ tensorå¢åŠ 1ï¼Œarrä¹Ÿéšä¹‹æ”¹å˜ 
#æˆ–ï¼š torch.add(tensor,1,out = tensor)
print(tensor)
print(arr)
```

```python
# å¯ä»¥ç”¨clone() æ–¹æ³•æ‹·è´å¼ é‡ï¼Œä¸­æ–­è¿™ç§å…³è”

tensor = torch.zeros(3)

#ä½¿ç”¨cloneæ–¹æ³•æ‹·è´å¼ é‡, æ‹·è´åçš„å¼ é‡å’ŒåŸå§‹å¼ é‡å†…å­˜ç‹¬ç«‹
arr = tensor.clone().numpy() # ä¹Ÿå¯ä»¥ä½¿ç”¨tensor.data.numpy()
print("before add 1:")
print(tensor)
print(arr)

print("\nafter add 1:")

#ä½¿ç”¨ å¸¦ä¸‹åˆ’çº¿çš„æ–¹æ³•è¡¨ç¤ºè®¡ç®—ç»“æœä¼šè¿”å›ç»™è°ƒç”¨ å¼ é‡
tensor.add_(1) #ç»™ tensorå¢åŠ 1ï¼Œarrä¸å†éšä¹‹æ”¹å˜
print(tensor)
print(arr)
```

```python
# itemæ–¹æ³•å’Œtolistæ–¹æ³•å¯ä»¥å°†å¼ é‡è½¬æ¢æˆPythonæ•°å€¼å’Œæ•°å€¼åˆ—è¡¨
scalar = torch.tensor(1.0)
s = scalar.item()
print(s)
print(type(s))

tensor = torch.rand(2,2)
t = tensor.tolist()
print(t)
print(type(t))
```

**å¦‚æœæœ¬ä¹¦å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œæƒ³é¼“åŠ±ä¸€ä¸‹ä½œè€…ï¼Œè®°å¾—ç»™æœ¬é¡¹ç›®åŠ ä¸€é¢—æ˜Ÿæ˜Ÿstarâ­ï¸ï¼Œå¹¶åˆ†äº«ç»™ä½ çš„æœ‹å‹ä»¬å–”ğŸ˜Š!** 

å¦‚æœå¯¹æœ¬ä¹¦å†…å®¹ç†è§£ä¸Šæœ‰éœ€è¦è¿›ä¸€æ­¥å’Œä½œè€…äº¤æµçš„åœ°æ–¹ï¼Œæ¬¢è¿åœ¨å…¬ä¼—å·"ç®—æ³•ç¾é£Ÿå±‹"ä¸‹ç•™è¨€ã€‚ä½œè€…æ—¶é—´å’Œç²¾åŠ›æœ‰é™ï¼Œä¼šé…Œæƒ…äºˆä»¥å›å¤ã€‚

ä¹Ÿå¯ä»¥åœ¨å…¬ä¼—å·åå°å›å¤å…³é”®å­—ï¼š**åŠ ç¾¤**ï¼ŒåŠ å…¥è¯»è€…äº¤æµç¾¤å’Œå¤§å®¶è®¨è®ºã€‚

![ç®—æ³•ç¾é£Ÿå±‹logo.png](./data/ç®—æ³•ç¾é£Ÿå±‹äºŒç»´ç .jpg)


